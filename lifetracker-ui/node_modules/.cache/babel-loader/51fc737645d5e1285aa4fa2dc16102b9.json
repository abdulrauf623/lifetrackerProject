{"ast":null,"code":"import _regeneratorRuntime from\"/Users/abdul.karim/lifetrackerProject/lifetracker-ui/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/abdul.karim/lifetrackerProject/lifetracker-ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/abdul.karim/lifetrackerProject/lifetracker-ui/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/abdul.karim/lifetrackerProject/lifetracker-ui/node_modules/@babel/runtime/helpers/esm/createClass.js\";import axios from\"axios\";var APIClient=/*#__PURE__*/function(){function APIClient(remoteHostUrl){_classCallCheck(this,APIClient);this.remoteHostUrl=remoteHostUrl;this.token=null;this.tokenName=\"rate_my_token_setup\";}_createClass(APIClient,[{key:\"setToken\",value:function setToken(token){this.token=token;localStorage.setItem(this.tokenName,token);}},{key:\"request\",value:function(){var _request=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref){var endpoint,_ref$method,method,_ref$data,data,url,headers,res,_error$response,_error$response$data,_error$response$data$,message;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:endpoint=_ref.endpoint,_ref$method=_ref.method,method=_ref$method===void 0?\"GET\":_ref$method,_ref$data=_ref.data,data=_ref$data===void 0?{}:_ref$data;url=\"\".concat(this.remoteHostUrl,\"/\").concat(endpoint);headers={\"Content-Type\":\"application/json\"};if(this.token){headers[\"Authorization\"]=\"Bearer \".concat(this.token);}_context.prev=4;_context.next=7;return axios({url:url,method:method,data:data,headers:headers});case 7:res=_context.sent;return _context.abrupt(\"return\",{data:res.data,error:null});case 11:_context.prev=11;_context.t0=_context[\"catch\"](4);message=_context.t0===null||_context.t0===void 0?void 0:(_error$response=_context.t0.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:(_error$response$data$=_error$response$data.error)===null||_error$response$data$===void 0?void 0:_error$response$data$.message;return _context.abrupt(\"return\",{data:null,error:message||String(_context.t0)});case 15:case\"end\":return _context.stop();}}},_callee,this,[[4,11]]);}));function request(_x){return _request.apply(this,arguments);}return request;}()},{key:\"fetchPostFromToken\",value:function(){var _fetchPostFromToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var user,id,result;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return this.fetchUserFromToken();case 2:user=_context2.sent;console.log(\"User fetched from token\",user);id=user.data.user.id;_context2.next=7;return this.request({endpoint:\"exercise/\".concat(id),method:\"GET\"});case 7:result=_context2.sent;console.log(\"Result here\",result);return _context2.abrupt(\"return\",result);case 10:case\"end\":return _context2.stop();}}},_callee2,this);}));function fetchPostFromToken(){return _fetchPostFromToken.apply(this,arguments);}return fetchPostFromToken;}()},{key:\"fetchUserFromToken\",value:function(){var _fetchUserFromToken=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var result;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return this.request({endpoint:\"author/me\",method:\"GET\"});case 2:result=_context3.sent;console.log(\"fetch user?\",result);return _context3.abrupt(\"return\",result);case 5:case\"end\":return _context3.stop();}}},_callee3,this);}));function fetchUserFromToken(){return _fetchUserFromToken.apply(this,arguments);}return fetchUserFromToken;}()},{key:\"createPost\",value:function(){var _createPost=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(post){return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return this.request({endpoint:\"exercise\",method:\"POST\",data:post});case 2:return _context4.abrupt(\"return\",_context4.sent);case 3:case\"end\":return _context4.stop();}}},_callee4,this);}));function createPost(_x2){return _createPost.apply(this,arguments);}return createPost;}()},{key:\"loginUser\",value:function(){var _loginUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(credentials){return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return this.request({endpoint:\"author/login\",method:\"POST\",data:credentials});case 2:return _context5.abrupt(\"return\",_context5.sent);case 3:case\"end\":return _context5.stop();}}},_callee5,this);}));function loginUser(_x3){return _loginUser.apply(this,arguments);}return loginUser;}()},{key:\"signUpUser\",value:function(){var _signUpUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(credentials){return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return this.request({endpoint:\"author/register\",method:\"POST\",data:credentials});case 2:return _context6.abrupt(\"return\",_context6.sent);case 3:case\"end\":return _context6.stop();}}},_callee6,this);}));function signUpUser(_x4){return _signUpUser.apply(this,arguments);}return signUpUser;}()},{key:\"logOutUser\",value:function(){var _logOutUser=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(){return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:this.setToken(null);localStorage.setItem(this.tokenName,\"\");case 2:case\"end\":return _context7.stop();}}},_callee7,this);}));function logOutUser(){return _logOutUser.apply(this,arguments);}return logOutUser;}()}]);return APIClient;}();// module.exports = new APIClient(\n//   process.env.REACT_APP_REMOTE_HOST_URL || \"http://localhost:3001\"\n// );\nexport default new APIClient(process.env.REACT_APP_REMOTE_HOST_URL||\"http://localhost:3001\");","map":{"version":3,"names":["axios","APIClient","remoteHostUrl","token","tokenName","localStorage","setItem","endpoint","method","data","url","headers","res","error","message","response","String","fetchUserFromToken","user","console","log","id","request","result","post","credentials","setToken","process","env","REACT_APP_REMOTE_HOST_URL"],"sources":["/Users/abdul.karim/lifetrackerProject/lifetracker-ui/src/componentss/service/APIClient.js"],"sourcesContent":["import axios from \"axios\";\n\nclass APIClient {\n  constructor(remoteHostUrl) {\n    this.remoteHostUrl = remoteHostUrl;\n    this.token = null;\n    this.tokenName = `rate_my_token_setup`;\n  }\n\n  setToken(token) {\n    this.token = token;\n    localStorage.setItem(this.tokenName, token);\n  }\n\n  async request({ endpoint, method = `GET`, data = {} }) {\n    const url = `${this.remoteHostUrl}/${endpoint}`;\n\n    const headers = {\n      \"Content-Type\": \"application/json\",\n    };\n\n    if (this.token) {\n      headers[\"Authorization\"] = `Bearer ${this.token}`;\n    }\n    try {\n      const res = await axios({ url, method, data, headers });\n\n      return { data: res.data, error: null };\n    } catch (error) {\n      const message = error?.response?.data?.error?.message;\n\n      return { data: null, error: message || String(error) };\n    }\n  }\n\n  async fetchPostFromToken() {\n    const user = await this.fetchUserFromToken();\n    console.log(\"User fetched from token\", user);\n    const id = user.data.user.id;\n    const result = await this.request({\n      endpoint: `exercise/${id}`,\n      method: `GET`,\n    });\n    console.log(\"Result here\", result);\n    return result;\n  }\n\n  async fetchUserFromToken() {\n    const result = await this.request({ endpoint: `author/me`, method: `GET` });\n\n    console.log(\"fetch user?\", result);\n\n    return result;\n  }\n\n  async createPost(post) {\n    return await this.request({\n      endpoint: `exercise`,\n      method: `POST`,\n      data: post,\n    });\n  }\n\n  async loginUser(credentials) {\n    return await this.request({\n      endpoint: `author/login`,\n      method: `POST`,\n      data: credentials,\n    });\n  }\n\n  async signUpUser(credentials) {\n    return await this.request({\n      endpoint: `author/register`,\n      method: `POST`,\n      data: credentials,\n    });\n  }\n\n  async logOutUser() {\n    this.setToken(null);\n    localStorage.setItem(this.tokenName, \"\");\n  }\n}\n\n// module.exports = new APIClient(\n//   process.env.REACT_APP_REMOTE_HOST_URL || \"http://localhost:3001\"\n// );\n\nexport default new APIClient(\n  process.env.REACT_APP_REMOTE_HOST_URL || \"http://localhost:3001\"\n);\n"],"mappings":"sjBAAA,MAAOA,MAAP,KAAkB,OAAlB,C,GAEMC,U,yBACJ,mBAAYC,aAAZ,CAA2B,iCACzB,KAAKA,aAAL,CAAqBA,aAArB,CACA,KAAKC,KAAL,CAAa,IAAb,CACA,KAAKC,SAAL,uBACD,C,8CAED,kBAASD,KAAT,CAAgB,CACd,KAAKA,KAAL,CAAaA,KAAb,CACAE,YAAY,CAACC,OAAb,CAAqB,KAAKF,SAA1B,CAAqCD,KAArC,EACD,C,yGAED,2QAAgBI,QAAhB,MAAgBA,QAAhB,kBAA0BC,MAA1B,CAA0BA,MAA1B,uDAA0CC,IAA1C,CAA0CA,IAA1C,oBAAiD,EAAjD,WACQC,GADR,WACiB,KAAKR,aADtB,aACuCK,QADvC,EAGQI,OAHR,CAGkB,CACd,eAAgB,kBADF,CAHlB,CAOE,GAAI,KAAKR,KAAT,CAAgB,CACdQ,OAAO,CAAC,eAAD,CAAP,kBAAqC,KAAKR,KAA1C,EACD,CATH,sCAWsBH,MAAK,CAAC,CAAEU,GAAG,CAAHA,GAAF,CAAOF,MAAM,CAANA,MAAP,CAAeC,IAAI,CAAJA,IAAf,CAAqBE,OAAO,CAAPA,OAArB,CAAD,CAX3B,QAWUC,GAXV,+CAaW,CAAEH,IAAI,CAAEG,GAAG,CAACH,IAAZ,CAAkBI,KAAK,CAAE,IAAzB,CAbX,4DAeUC,OAfV,kEAeoB,YAAOC,QAf3B,gEAeoB,gBAAiBN,IAfrC,sEAeoB,qBAAuBI,KAf3C,gDAeoB,sBAA8BC,OAflD,iCAiBW,CAAEL,IAAI,CAAE,IAAR,CAAcI,KAAK,CAAEC,OAAO,EAAIE,MAAM,aAAtC,CAjBX,uE,gNAqBA,oLACqB,MAAKC,kBAAL,EADrB,QACQC,IADR,gBAEEC,OAAO,CAACC,GAAR,CAAY,yBAAZ,CAAuCF,IAAvC,EACMG,EAHR,CAGaH,IAAI,CAACT,IAAL,CAAUS,IAAV,CAAeG,EAH5B,wBAIuB,MAAKC,OAAL,CAAa,CAChCf,QAAQ,oBAAcc,EAAd,CADwB,CAEhCb,MAAM,MAF0B,CAAb,CAJvB,QAIQe,MAJR,gBAQEJ,OAAO,CAACC,GAAR,CAAY,aAAZ,CAA2BG,MAA3B,EARF,iCASSA,MATT,gE,+OAYA,4KACuB,MAAKD,OAAL,CAAa,CAAEf,QAAQ,YAAV,CAAyBC,MAAM,MAA/B,CAAb,CADvB,QACQe,MADR,gBAGEJ,OAAO,CAACC,GAAR,CAAY,aAAZ,CAA2BG,MAA3B,EAHF,iCAKSA,MALT,+D,+NAQA,kBAAiBC,IAAjB,+IACe,MAAKF,OAAL,CAAa,CACxBf,QAAQ,WADgB,CAExBC,MAAM,OAFkB,CAGxBC,IAAI,CAAEe,IAHkB,CAAb,CADf,sH,wMAQA,kBAAgBC,WAAhB,+IACe,MAAKH,OAAL,CAAa,CACxBf,QAAQ,eADgB,CAExBC,MAAM,OAFkB,CAGxBC,IAAI,CAAEgB,WAHkB,CAAb,CADf,sH,uMAQA,kBAAiBA,WAAjB,+IACe,MAAKH,OAAL,CAAa,CACxBf,QAAQ,kBADgB,CAExBC,MAAM,OAFkB,CAGxBC,IAAI,CAAEgB,WAHkB,CAAb,CADf,sH,0MAQA,0IACE,KAAKC,QAAL,CAAc,IAAd,EACArB,YAAY,CAACC,OAAb,CAAqB,KAAKF,SAA1B,CAAqC,EAArC,EAFF,6D,iHAMF;AACA;AACA;AAEA,cAAe,IAAIH,UAAJ,CACb0B,OAAO,CAACC,GAAR,CAAYC,yBAAZ,EAAyC,uBAD5B,CAAf"},"metadata":{},"sourceType":"module"}